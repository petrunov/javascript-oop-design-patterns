<!DOCTYPE html>
<html>
<head>
  <title>Undo/Redo example with Command pattern</title>
  <meta charset="UTF-8" />
  <style>
    * {margin: 0; padding: 0;}
    html, body {
      height: 100%;
    }
    button {padding: 2px;}
    #controls {outline: 1px solid black; outline-offset: -1px; background: #ccc;}
    #controls {height: 3%; padding: 10px;}
  </style>

  <link rel="stylesheet" href="http://code.jquery.com/ui/1.12.0/themes/base/jquery-ui.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.1.0/jquery.min.js"></script>


  <script src="https://code.jquery.com/ui/1.12.0/jquery-ui.js"></script>

  <script src="domToJson.js"></script>
  <script src="stringify.js"></script>
  
  <script src="hello.json"></script>
  <script src="smiley.json"></script>
  <script src="dancingman.json"></script>

  <script src="Commander.js"></script>
  <script src="CreateCmd.js"></script>
  <script src="DragCmd.js"></script>
  <script src="DeleteCmd.js"></script>
  <script src="ResizeCmd.js"></script>
  <script>
    let lastClicked = null
    let globalId = 0

    let animations = {hello, smiley, dancingman}

    $('document').ready(function() {

      $('body').keydown(function(e) {
        if(e.keyCode === 46 || e.keyCode === 8) {
          commander.execute(Object.assign({}, DeleteCmd), {receiver: lastClicked});
        }
      })

      $('.clickable').click(clickHandler)
    
      function clickHandler(e) {
        switch ($(this).attr('id')) {
          case 'create':
            commander.execute(Object.assign({}, CreateCmd))
            break
          case 'delete':
            commander.execute(Object.assign({}, DeleteCmd), {receiver: lastClicked});
            break
          case 'undo':
            commander.undo()
            break
          case 'redo':
            commander.redo()
            break
          case 'rewind':
            commander.rewind()
            break
          case 'play':
            commander.play()
            break
          case 'save':
            commander.save()
            break
          case 'load':
            let json = (animations[prompt("Name of animation?", "smiley")])
            commander.load(json)
            break
        }
      }
    })  
  </script>
</head>
<body>
<div id="controls">
  <button id="create" class="clickable">create</button>
  <button id="delete" class="clickable">delete</button>
  <button id="undo" class="clickable">undo</button>
  <button id="redo" class="clickable">redo</button>
  <button id="rewind" class="clickable">  << </button>
  <button id="play" class="clickable"> >> </button>
  <button id="save" class="clickable">save</button>
  <button id="load" class="clickable">load</button>
</div>

</body>
</html>